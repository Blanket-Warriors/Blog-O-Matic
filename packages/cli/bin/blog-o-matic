#!/usr/bin/env node
const fs = require("fs")
const yaml = require("js-yaml")
const path = require("path")
const argv = require("yargs").argv
const cli = require("../dist/index")

const command = argv._[0]

if (command === "init") cli.blogGenerator()
if (command === "post") cli.postGenerator()
if (command === "publish") {
  const yamlFile = path.resolve(process.cwd(), "blog.config.yml")
  if (!fs.existsSync(yamlFile)) {
    throw new Error("This is not a blog! Please go to the dir where blog.config.yml exists.")
  }

  const config = yaml.safeLoad(fs.readFileSync(yamlFile, "utf8")) || {}
  if (config.blog.publisher === "local") cli.fsPublisher(path.resolve(process.cwd(), config.blog.out))
}
